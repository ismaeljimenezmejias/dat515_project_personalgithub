<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Publish a bike</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>body{font-family:system-ui, sans-serif;margin:2rem;background:#f4f4f4}label{display:block;margin:8px 0}button{padding:6px 12px}</style>
</head>
<body>
  <a href="/">← Home</a>
  <h1>Publish a bike</h1>
  <div>
    <label>Title <input id="title" /></label>
    <label>Price (€) <input id="price" type="number" /></label>
    <label><input id="rentable" type="checkbox" /> Rentable</label>
    <div style="margin-top:12px">
      <button id="submit">Publish</button>
      <span id="status" style="margin-left:12px"></span>
    </div>
  </div>

  <script>
    document.getElementById('submit').addEventListener('click', async function(){
      const title = document.getElementById('title').value;
      const price = document.getElementById('price').value;
      const rentable = document.getElementById('rentable').checked;
      if(!title || !title.trim()) return alert('Title required');
      const payload = { title: title.trim(), price: price ? Number(price) : 0, rentable };
      const statusEl = document.getElementById('status');
      statusEl.textContent = 'Publishing...';
      try{
  const res = await fetch('/api/bikes', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(payload) });
        const json = await res.json();
        if(res.ok){
          statusEl.textContent = 'Published ✓';
          document.getElementById('title').value='';
          document.getElementById('price').value='';
          document.getElementById('rentable').checked=false;
        } else {
          statusEl.textContent = 'Error: ' + (json.error||res.statusText);
        }
      }catch(err){
        statusEl.textContent = 'Network error';
      }
    });
  </script>
</body>
</html>
